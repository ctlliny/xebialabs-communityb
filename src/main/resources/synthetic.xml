<?xml version='1.0' encoding='UTF-8'?>
<!--

    THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS
    FOR A PARTICULAR PURPOSE. THIS CODE AND INFORMATION ARE NOT SUPPORTED BY XEBIALABS.

-->
<synthetic xsi:schemaLocation="http://www.xebialabs.com/deployit/synthetic synthetic.xsd" xmlns="http://www.xebialabs.com/deployit/synthetic" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <type type="servicenow.Task" extends="xlrelease.PythonScript" virtual="true">
        <property name="iconLocation" default="servicenow/servicenow.png" hidden="true" />

        <property name="servicenowServer" category="input" label="Server" referenced-type="servicenow.Server" kind="ci"/>
        <property name="username" category="input" label="username" required="true" />
        <property name="password" password="true" category="input" required="true" />
    </type>

    <type type="servicenow.CreateRecord" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/CreateRequest.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />
        <property name="shortDescription" category="input" label="Short Description" required="true" />
        <property name="comments" category="input" label="Comments" required="true" />

        <property name="sysId" category="output"/> 
        <property name="Ticket" category="output"/>
    </type>

    <type type="servicenow.CreateRequest" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/CreateRequest.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />
        <property name="shortDescription" category="input" label="Short Description" required="true" />
        <property name="comments" category="input" label="Comments" required="true" />

        <property name="sysId" category="output"/>
        <property name="Ticket" category="output"/>
    </type>

    <type type="servicenow.UpdateRecord" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/UpdateRecord.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />
        <property name="sysId"   category="input" required="true" />
        <property name="content" category="input" label="Request Content" required="true" size="large" />

    </type>

    <type type="servicenow.FindChangeRequestByTicket" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/FindRecord.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />
        <property name="ticket"   category="input" required="true" />

        <property name="sysId" category="output"/>
    </type>

    <type type="servicenow.CreateTask" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/CreateTask.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" required="true" default="change_task" hidden="true" />
        <property name="content" category="input" label="Task JSON Content" required="true" size="large" />

        <property name="taskId" category="output"/>
        <property name="Task" category="output"/>
    </type>

    <type type="servicenow.UpdateTask" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/UpdateRecord.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_task" required="true" hidden="true" />
        <property name="sysId"   category="input" required="true" />
        <property name="content" category="input" label="Request Content" required="true" size="large" />

    </type>

    <type type="servicenow.CheckStatus" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/CheckStatus.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" required="true" />
        <property name="sysId" category="input" label="System ID" required="true" />

        <property name="status" category="output"/> 
    </type>

    <type type="servicenow.RequestApproval" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/RequestApproval.py" hidden="true" />

        <property name="shortDescription" category="input" label="Short Description" required="true" />
        <property name="description" category="input" label="Description" required="true" />
        <property name="content" default="{&quot;short_description&quot;:&quot;%s&quot;,&quot;description&quot;:&quot;%s&quot;,&quot;category&quot;:&quot;XLDeploy&quot;,&quot;u_supporting_service&quot;:&quot;Exchange Support&quot;,&quot;assignment_group&quot;:&quot;Global Software Change Group&quot;,&quot;justification&quot;:&quot;XLDeploy&quot;,&quot;requested_by_date&quot;:&quot;08-08-2014&quot;}" category="input" hidden="true" />
        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />

        <property name="sysId" category="output"/>
        <property name="ticket" category="output"/>
    </type>

    <type type="servicenow.PollingCheckStatus" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/PollingCheckStatus.py" hidden="true" />

        <property name="tableName" category="input" label="Table Name" default="change_request" required="true" hidden="true" />
        <property name="sysId" category="input" label="System ID" required="true" />
        <property name="pollInterval" category="input" kind="integer" label="Polling Interval" required="true" default="30" />
        <property name="statusField" category="input" label="Status Field" required="true" default="state" />
        <property name="checkForStatus" category="input" label="Status Value to check for" required="true" />

        <property name="status" category="output"/>
        <property name="ticket" category="output"/>
    </type>

    <type type="servicenow.UpdateCMDB" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/UpdateCMDB.py" hidden="true" />

        <property name="environment" category="input" label="Environment" required="true" />
        <property name="applicationName" category="input" label="Application Name" required="true" />
        <property name="company" category="input" label="Company" required="true" />
        <property name="configAdminGroup" category="input" label="Config Admin Group" required="true" />
        <property name="version" category="input" label="Version" required="true" />
        <property name="virtualMachine" category="input" label="Virtual Machine" required="false" />
        <property name="tomcat" category="input" label="Tomcat" required="false" />
        <property name="mysql" category="input" label="MySql" required="false" />
        <property name="cfSpace" category="input" label="CF Space" required="false" />

        <property name="sysId" category="output"/> 
    </type>

    <type type="servicenow.GetChangeRequest" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/GetChangeRequest.py" hidden="true" />

        <property name="tableName" category="input" default="change_request" required="true" hidden="true" />
        <property name="number" category="input" label="Number" required="true" />
        <property name="fieldNames" category="input" label="Field Names" required="true" kind="list_of_string" description="List of field names to be displayed"/>
    </type>

    <type type="servicenow.CheckChangeRequest" extends="servicenow.Task">
        <property name="scriptLocation" default="servicenow/CheckChangeRequest.py" hidden="true" />

        <property name="tableName" category="input" default="change_request" required="true" hidden="true" />
        <property name="expectedStatus" category="input" default="Closed Complete,Closed Incomplete,Closed Skipped" hidden="true"/>

        <property name="number" category="input" label="Number" required="true" />
    </type>

    <type type="servicenow.CreateIncident" extends="servicenow.CreateRequest">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true" hidden="true" />
    </type>

    <type type="servicenow.UpdateIncident" extends="servicenow.UpdateRecord">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true" hidden="true" />
    </type>

    <type type="servicenow.FindIncidentByTicket" extends="servicenow.FindChangeRequestByTicket">
        <property name="tableName" category="input" label="Table Name" default="incident" required="true" hidden="true" />
    </type>

    <type type="servicenow.FindChangeTaskByTaskId" extends="servicenow.FindChangeRequestByTicket">
        <property name="tableName" category="input" label="Table Name" default="change_task" required="true" hidden="true" />
    </type>


    <type type="servicenow.Server" extends="configuration.HttpConnection">
        <property name="changeRecordTableName" 
                  label="Change Record Table Name (Required for Generate Release)" 
                  required="true" 
                  default="change_request"/>
        <property name="changeTaskTableName" 
                  label="Change Task Table Name (Required for Generate Release)" 
                  required="true" 
                  default="change_task" />
    </type>

    <!-- ============ UI extensions: ============ -->

    <type type="servicenow.ServiceNowQueryTile" label="Service Now query tile" extends="xlrelease.Tile">
        <property name="uri" hidden="true" default="include/ServiceNowQueryTile/servicenow-query-summary-view.html" />
        <property name="detailsUri" hidden="true" default="include/ServiceNowQueryTile/servicenow-query-details-view.html" />
        <property name="title" description="Tile title" default="ServiceNow tickets"/>
        <property category="input" name="servicenowServer" referenced-type="servicenow.Server" kind="ci" label="Server" description="ServiceNow server id to connect to"/>
        <property category="input" name="username" required="false" description="Overrides the username used to connect to the server"/>
        <property category="input" name="password" password="true" required="false" description="Overrides the password used to connect to the server"/>
        <property category="input" name="tableName" required="true" default="incident" description="ServiceNow table name (in lower case) (for example problem, change_request etc) Default value: incident"/>
        <property category="input" name="query" required="false" size="large" description="ServiceNow query"/>
        <property category="input" name="detailsViewColumns" hidden="true" kind="map_string_string" default="number:number,short_description,priority:priority,state:state,assigned_to:assigned_to.display_value" description="Map of columns displayed in details view of tile. For a referenced type column, display_value should be in the value of key:value pair separated by . (eg. assigned_to:assigned_to.display_value)"/>
    </type>

</synthetic>
